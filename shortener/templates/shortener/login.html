{% extends 'shortener/base.html' %}

{% block title %}Login - Vulnerable URL Shortener{% endblock %}
{% block header %}Login{% endblock %}

{% block content %}
<div class="alert alert-warning">
    <p>This login demonstrates authentication vulnerabilities including missing CSRF protection and weak session management.</p>
</div>

{% if error %}
    <div class="alert alert-danger">{{ error }}</div>
{% endif %}

<form method="post">
    <!-- FIX: Add CSRF token to prevent login CSRF attacks -->
    <!-- {% csrf_token %} -->
    <div class="form-group">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required>
    </div>
    
    <div class="form-group">
        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required>
    </div>
    
    <button type="submit">Login</button>
</form>

<p><small>
    Test credentials: admin/admin<br>
    Vulnerabilities: No CSRF protection, no rate limiting, weak sessions
</small></p>
{% endblock %}
